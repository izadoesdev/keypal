---
title: Memory Storage
description: In-memory storage adapter
icon: Database
---

# Memory Storage

Memory storage is the default storage adapter. It stores keys in a JavaScript Map in memory. No setup required - it works out of the box.

## Usage

```typescript
import { createKeys } from 'keypal'

// Memory storage is the default - no configuration needed
const keys = createKeys({
  prefix: 'sk_',
})

// Or explicitly specify it
const keys = createKeys({
  prefix: 'sk_',
  storage: 'memory',
})
```

## How It Works

Keys are stored in an in-memory `Map` structure with optimized indexing:

- **O(1) Hash Lookups**: A dedicated hash index maps key hashes to IDs for instant verification
- **O(1) Owner Lookups**: An owner index maps owner IDs to their key sets for fast listing
- **Hash Collision Detection**: Automatically detects and rejects duplicate key hashes
- **No external dependencies**: Everything runs in-process
- **No network calls**: Zero latency for storage operations

### Internal Structure

```typescript
// Primary storage: id -> ApiKeyRecord
keys: Map<string, ApiKeyRecord>

// Hash index for O(1) verification: keyHash -> id
hashIndex: Map<string, string>

// Owner index for O(1) listing: ownerId -> Set<id>
ownerIndex: Map<string, Set<string>>
```

## Important Notes

**Data is not persistent**: All keys are lost when your application restarts. This makes memory storage suitable for:
- Local development and testing
- Prototypes and demos
- Single-instance applications that don't need persistence

**Not distributed**: Each application instance has its own separate memory store. If you run multiple instances, they won't share keys.

For production use with persistence, use [Redis](/docs/storage/redis) or a database adapter like [Drizzle](/docs/storage/drizzle).

